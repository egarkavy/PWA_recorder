import{a as et,c as it,g as nt,h as at,i as ot}from"./chunk-RAV5WDMC.js";import"./chunk-YF42NFGH.js";import{a as tt}from"./chunk-222CUUGD.js";import{b as J,e as W,f as X,k as Y,l as Z}from"./chunk-X65V2RTM.js";import{F as T,T as G}from"./chunk-HKA473OH.js";import{d as K,e as U}from"./chunk-JY5QF2BW.js";import{Ab as x,Ca as O,Fa as u,Nb as A,Ob as H,Qa as g,Qb as L,Ta as q,Ua as E,Va as c,Wa as C,Xa as l,Ya as m,Yb as j,Za as v,_b as z,a as V,ab as I,b as S,bb as P,c as k,da as p,ea as $,fb as y,hb as r,ja as _,ka as f,kb as Q,lb as w,p as F,qb as N,sb as d,tb as h,ub as D,wb as M,xb as b,z as R,zb as B}from"./chunk-ESE33L4O.js";var rt=["pageTitlePortal"],st=["backButtonPortal"];function lt(t,a){if(t&1&&v(0,"pyp-patient-info",6),t&2){let n=r();g("patient",n)}}function pt(t,a){if(t&1){let n=P();l(0,"pyp-transcription-item",8),y("edit",function(){_(n);let e=r(2);return f(e.edit())})("save",function(e){_(n);let o=r(),s=r();return f(s.save(e,o))}),d(1,"async"),m()}if(t&2){let n=r(2);g("item",h(1,2,n.freshestTranscription$))("viewMode",n.itemViewMode())}}function ct(t,a){t&1&&I(0)}function mt(t,a){if(t&1&&(l(0,"div",9),c(1,ct,1,0,"ng-container",10),m()),t&2){r(2);let n=Q(5);u(),g("ngTemplateOutlet",n)}}function dt(t,a){if(t&1&&(c(0,lt,1,1,"pyp-patient-info",6),d(1,"equal"),d(2,"async"),c(3,pt,2,4,"pyp-transcription-item",7),d(4,"equal"),d(5,"async"),c(6,mt,2,1)),t&2){let n=r();C(0,D(1,2,h(2,5,n.isPatientPending$),!1)?0:-1),u(3),C(3,D(4,7,h(5,10,n.isTranscriptionsPending$),!1)?3:6)}}function _t(t,a){if(t&1){let n=P();l(0,"pyp-player-navigator",11),y("playRequest",function(){_(n);let e=r();return f(e.play())}),m()}}function ft(t,a){t&1&&v(0,"mat-spinner",12),t&2&&g("diameter",50)}function ut(t,a){t&1&&(l(0,"span",13),w(1,"Patient View"),m())}function gt(t,a){if(t&1){let n=P();l(0,"button",14),y("click",function(){_(n);let e=r();return f(e.onBack())}),l(1,"mat-icon"),w(2,"arrow_back"),m()()}}var Qt=(()=>{let a=class a{constructor(){this.hostClass="flex-all-available-space",this.viewContainerRef=p(E),this.toolbarBridgeService=p(tt),this.router=p(z),this.activatedRoute=p(j),this.patientDetailsFacade=p(Y),this.transcriptionsFacade=p(Z),this.details$=this.patientDetailsFacade.details$,this.transcriptions$=this.transcriptionsFacade.transcriptions$,this.isPatientPending$=this.patientDetailsFacade.isInit$,this.isTranscriptionsPending$=this.transcriptionsFacade.isInit$,this.itemViewMode=O(!0),this.freshestTranscription$=this.transcriptions$.pipe(R(i=>i.length>0),F(i=>i.sort((e,o)=>new Date(o.createdOn).getTime()-new Date(e.createdOn).getTime())[0]))}ngOnInit(){this.activatedRoute.paramMap.subscribe(i=>{let e=i.get("id");e&&(this.patientDetailsFacade.requestDetails(e),this.transcriptionsFacade.requestTranscriptions(e))})}ngAfterViewInit(){this.pageTitlePortal&&this.toolbarBridgeService.setToolbarMiddlePortal(this.pageTitlePortal),this.backButtonPortal&&this.toolbarBridgeService.setToolbarLeftPortal(this.backButtonPortal)}ngOnDestroy(){this.backButtonPortal?.detach(),this.pageTitlePortal?.detach(),this.toolbarBridgeService.resetLeftPortal(),this.toolbarBridgeService.resetToolbarMiddlePortal()}play(){this.router.navigate(["transcription"],{relativeTo:this.activatedRoute})}delete(i){this.transcriptionsFacade.deleteTranscription(i)}edit(){this.itemViewMode.set(!1)}save(i,e){this.transcriptionsFacade.updateTranscription(S(V({},i),{title:i.title||J(e.fullName,i.id)})),this.itemViewMode.set(!0)}onBack(){return k(this,null,function*(){if(!this.itemViewMode()){this.itemViewMode.set(!0);return}yield this.router.navigate(["/10"])})}};a.\u0275fac=function(e){return new(e||a)},a.\u0275cmp=$({type:a,selectors:[["pyp-patient-details"]],viewQuery:function(e,o){if(e&1&&(b(rt,5,T),b(st,5,T)),e&2){let s;M(s=B())&&(o.pageTitlePortal=s.first),M(s=B())&&(o.backButtonPortal=s.first)}},hostVars:2,hostBindings:function(e,o){e&2&&q(o.hostClass)},standalone:!0,features:[N],decls:10,vars:4,consts:[[1,"grow","flex","flex-col"],["class","bottom-0 sticky self-center"],["spinnerTemplate",""],["cdkPortal",""],["pageTitlePortal",""],["backButtonPortal",""],[3,"patient"],[3,"item","viewMode"],[3,"item","viewMode","edit","save"],[1,"transcriptions-spinner"],[4,"ngTemplateOutlet"],[1,"bottom-0","sticky","self-center",3,"playRequest"],["color","primary",1,"m-auto",3,"diameter"],[1,"line-clamp-2","whitespace-normal"],["mat-icon-button","","aria-label","Navigate back",3,"click"]],template:function(e,o){if(e&1&&(l(0,"div",0),c(1,dt,7,12),d(2,"async"),m(),c(3,_t,1,0,"pyp-player-navigator",1)(4,ft,1,1,"ng-template",null,2,x)(6,ut,2,0,"ng-template",3,4,x)(8,gt,3,0,"ng-template",3,5,x)),e&2){let s;u(),C(1,(s=h(2,2,o.details$))?1:-1,s),u(2),C(3,o.itemViewMode()?3:-1)}},dependencies:[L,A,H,X,W,U,K,et,it,G,ot,at,nt,T],styles:[".patient-spinner[_ngcontent-%COMP%], .transcriptions-spinner[_ngcontent-%COMP%]{display:flex;flex-grow:1}.patient-spinner.transcriptions-spinner[_ngcontent-%COMP%], .transcriptions-spinner.transcriptions-spinner[_ngcontent-%COMP%]{flex-grow:4}"],changeDetection:0});let t=a;return t})();export{Qt as PatientDetailsComponent};
