import{a as L,b as T}from"./chunk-FZVX62TG.js";import{W as m,c as g,d as S,e as u,n as d,o as v,p as F,q as $,s as l,t as A,v as R,w as b,x as f,y as w}from"./chunk-N5OPLCCF.js";import{$ as c,J as q,Pc as P,Sc as k,V as j,_b as y,a as p,b as a,da as s,p as I}from"./chunk-5ARDGOVG.js";var n=S({source:"App",events:{"Request Begin":u(),"Request End":u(),AllowScrolling:u(),PreventScrolling:u()}});var o=S({source:"Auth",events:{Init:u(),Login:g(),LoginSuccess:g(),LoginError:g(),Logout:u(),LogoutSuccess:u()}});var C={modelStatus:m.Init};var M=A(C,l(o.login,t=>a(p({},t),{modelStatus:m.Pending})),l(o.loginSuccess,t=>a(p({},t),{modelStatus:m.Success})),l(o.loginError,t=>a(p({},t),{modelStatus:m.Error})));var O={activeRequests:0,preventScrolling:!1};var B=A(O,l(n.requestBegin,t=>a(p({},t),{activeRequests:t.activeRequests+1})),l(n.requestEnd,t=>a(p({},t),{activeRequests:t.activeRequests-1})),l(n.allowScrolling,t=>a(p({},t),{preventScrolling:!1})),l(n.preventScrolling,t=>a(p({},t),{preventScrolling:!0})));var x="core",h=function(t){return t.App="app",t.Auth="auth",t}(h||{}),H={[h.App]:B,[h.Auth]:M};var K=F(x);var U=v(K,t=>t[h.App]),Y=v(U,t=>t.activeRequests!==0),G=v(U,t=>t.preventScrolling);var yt=(()=>{let e=class e{constructor(){this.store=s(d),this.appHasActiveRequests$=this.store.select(Y),this.preventScrolling$=this.store.select(G)}requestStarted(){this.store.dispatch(n.requestBegin())}requestEnded(){this.store.dispatch(n.requestEnd())}allowScrolling(){this.store.dispatch(n.allowScrolling())}preventScrolling(){this.store.dispatch(n.preventScrolling())}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=c({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var D=(()=>{let e=class e{constructor(){this.apiService=s(P)}login(r){return this.apiService.post("account",r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=c({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var z=(()=>{let e=class e{constructor(){this.authApiService=s(D)}login(r){return this.authApiService.login(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=c({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var J=(()=>{let e=class e{constructor(){this.actions$=s(b),this.apiFacade=s(z),this.authService=s(L),this.router=s(y),this.logout$=this.actions$.pipe(f(o.logout)),this.login$=R(()=>this.actions$.pipe(f(o.login),q(({auth:r})=>this.apiFacade.login(r).pipe(k(i=>o.loginSuccess({session:i}),i=>o.loginError({error:i})))))),this.loginSuccess$=R(()=>this.actions$.pipe(f(o.loginSuccess),I(({session:r})=>{this.authService.setToken(r.token),this.router.navigate(["/"])})),{dispatch:!1}),this.onLogout$=R(()=>this.actions$.pipe(f(o.logout),j(()=>(this.authService.reset(),this.router.navigate(["/",T.Auth]))),I(()=>o.logoutSuccess())),{dispatch:!1})}ngrxOnInitEffects(){return o.init()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=c({token:e,factory:e.\u0275fac});let t=e;return t})();var Zt=()=>[$(x,H),w(J)];var ie=(()=>{let e=class e{constructor(){this.store=s(d)}login(r){this.store.dispatch(o.login({auth:r}))}logout(){this.store.dispatch(o.logout())}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=c({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();export{Zt as a,ie as b,yt as c};
